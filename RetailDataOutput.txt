-------------------------------------------
Batch: 0
-------------------------------------------
+----------+-------+---------+----------+-----------+--------+---------+
|invoice_no|country|timestamp|total_cost|total_items|is_order|is_return|
+----------+-------+---------+----------+-----------+--------+---------+
+----------+-------+---------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 1
-------------------------------------------
+---------------+--------------+-------------------+-------------------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost         |total_items|is_order|is_return|
+---------------+--------------+-------------------+-------------------+-----------+--------+---------+
|154132544963872|United Kingdom|2021-07-07 19:35:13|-19.259999999999998|3          |0       |1        |
|154132544963873|United Kingdom|2021-07-07 19:35:34|33.72              |2          |1       |0        |
|154132544963874|United Kingdom|2021-07-07 19:35:51|41.64              |3          |1       |0        |
|154132544963875|United Kingdom|2021-07-07 19:35:56|77.70000000000002  |10         |1       |0        |
|154132544963876|United Kingdom|2021-07-07 19:35:56|30.45              |3          |1       |0        |
|154132544963877|United Kingdom|2021-07-07 19:35:58|5.68               |2          |1       |0        |
|154132544963878|United Kingdom|2021-07-07 19:36:00|5.95               |1          |1       |0        |
|154132544963879|United Kingdom|2021-07-07 19:36:03|37.63              |6          |1       |0        |
+---------------+--------------+-------------------+-------------------+-----------+--------+---------+

-------------------------------------------
Batch: 2
-------------------------------------------
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost        |total_items|is_order|is_return|
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|154132544963880|United Kingdom|2021-07-07 19:36:10|15.479999999999999|3          |1       |0        |
|154132544963881|United Kingdom|2021-07-07 19:36:14|103.22            |9          |1       |0        |
|154132544963882|United Kingdom|2021-07-07 19:36:27|49.12             |4          |1       |0        |
|154132544963883|United Kingdom|2021-07-07 19:36:30|17.0              |2          |1       |0        |
|154132544963884|United Kingdom|2021-07-07 19:36:38|30.36             |1          |1       |0        |
|154132544963885|United Kingdom|2021-07-07 19:36:51|18.64             |4          |1       |0        |
|154132544963886|United Kingdom|2021-07-07 19:36:53|-37.32            |2          |0       |1        |
|154132544963887|United Kingdom|2021-07-07 19:36:55|138.48999999999998|10         |1       |0        |
+---------------+--------------+-------------------+------------------+-----------+--------+---------+

-------------------------------------------
Batch: 3
-------------------------------------------
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost        |total_items|is_order|is_return|
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|154132544963888|United Kingdom|2021-07-07 19:37:13|61.199999999999996|1          |1       |0        |
|154132544963889|United Kingdom|2021-07-07 19:37:20|15.149999999999999|2          |1       |0        |
|154132544963890|United Kingdom|2021-07-07 19:37:55|51.55             |3          |1       |0        |
|154132544963891|United Kingdom|2021-07-07 19:38:05|102.30000000000001|7          |1       |0        |
+---------------+--------------+-------------------+------------------+-----------+--------+---------+

-------------------------------------------
Batch: 4
-------------------------------------------
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost        |total_items|is_order|is_return|
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|154132544963892|United Kingdom|2021-07-07 19:38:17|26.26             |2          |1       |0        |
|154132544963893|United Kingdom|2021-07-07 19:38:17|292.13            |12         |1       |0        |
|154132544963894|United Kingdom|2021-07-07 19:38:34|23.4              |1          |1       |0        |
|154132544963895|United Kingdom|2021-07-07 19:38:36|1133.41           |9          |1       |0        |
|154132544963896|United Kingdom|2021-07-07 19:38:42|20.759999999999998|2          |1       |0        |
|154132544963897|United Kingdom|2021-07-07 19:38:46|30.98             |2          |1       |0        |
|154132544963898|United Kingdom|2021-07-07 19:38:54|32.0              |3          |1       |0        |
|154132544963899|United Kingdom|2021-07-07 19:38:59|4.92              |1          |1       |0        |
|154132544963900|United Kingdom|2021-07-07 19:39:05|183.39000000000001|11         |1       |0        |
+---------------+--------------+-------------------+------------------+-----------+--------+---------+

-------------------------------------------
Batch: 5
-------------------------------------------
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost        |total_items|is_order|is_return|
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|154132544963901|United Kingdom|2021-07-07 19:39:22|103.32            |8          |1       |0        |
|154132544963902|United Kingdom|2021-07-07 19:39:22|23.3              |2          |1       |0        |
|154132544963903|United Kingdom|2021-07-07 19:39:25|107.38            |4          |1       |0        |
|154132544963904|United Kingdom|2021-07-07 19:39:25|12.3              |1          |1       |0        |
|154132544963905|United Kingdom|2021-07-07 19:39:27|15.48             |2          |1       |0        |
|154132544963906|United Kingdom|2021-07-07 19:39:30|32.449999999999996|4          |1       |0        |
|154132544963907|United Kingdom|2021-07-07 19:39:30|20.4              |1          |1       |0        |
|154132544963908|United Kingdom|2021-07-07 19:39:34|19.2              |2          |1       |0        |
|154132544963909|United Kingdom|2021-07-07 19:39:38|22.7              |3          |1       |0        |
|154132544963910|United Kingdom|2021-07-07 19:39:40|45.06             |3          |1       |0        |
|154132544963911|United Kingdom|2021-07-07 19:39:43|4.199999999999999 |2          |1       |0        |
|154132544963912|United Kingdom|2021-07-07 19:39:51|88.76             |3          |1       |0        |
|154132544963913|United Kingdom|2021-07-07 19:39:52|2.09              |2          |1       |0        |
|154132544963914|Switzerland   |2021-07-07 19:39:57|28.759999999999998|2          |1       |0        |
|154132544963915|United Kingdom|2021-07-07 19:40:01|80.74             |3          |1       |0        |
+---------------+--------------+-------------------+------------------+-----------+--------+---------+

-------------------------------------------
Batch: 6
-------------------------------------------
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost        |total_items|is_order|is_return|
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|154132544963916|United Kingdom|2021-07-07 19:40:14|49.11             |5          |1       |0        |
|154132544963917|United Kingdom|2021-07-07 19:40:15|23.4              |3          |1       |0        |
|154132544963918|United Kingdom|2021-07-07 19:40:22|62.99000000000001 |3          |1       |0        |
|154132544963919|United Kingdom|2021-07-07 19:40:44|95.30000000000001 |3          |1       |0        |
|154132544963920|United Kingdom|2021-07-07 19:40:52|190.45000000000002|4          |1       |0        |
|154132544963921|United Kingdom|2021-07-07 19:41:00|-20.8             |1          |0       |1        |
|154132544963922|United Kingdom|2021-07-07 19:41:03|3.81              |1          |1       |0        |
+---------------+--------------+-------------------+------------------+-----------+--------+---------+

-------------------------------------------
Batch: 7
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132544963923|United Kingdom|2021-07-07 19:41:14|167.1     |3          |1       |0        |
|154132544963924|United Kingdom|2021-07-07 19:41:17|105.96    |7          |1       |0        |
|154132544963925|United Kingdom|2021-07-07 19:41:18|29.42     |3          |1       |0        |
|154132544963926|EIRE          |2021-07-07 19:41:23|2.55      |1          |1       |0        |
|154132544963927|United Kingdom|2021-07-07 19:41:26|2.92      |2          |1       |0        |
|154132544963928|United Kingdom|2021-07-07 19:42:00|15.0      |1          |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 8
-------------------------------------------
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost        |total_items|is_order|is_return|
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|154132544963929|United Kingdom|2021-07-07 19:42:03|3.9               |1          |1       |0        |
|154132544963930|United Kingdom|2021-07-07 19:42:06|238.77            |11         |1       |0        |
|154132544963931|United Kingdom|2021-07-07 19:42:11|22.5              |1          |1       |0        |
|154132544963932|United Kingdom|2021-07-07 19:42:14|14.16             |1          |1       |0        |
|154132544963933|United Kingdom|2021-07-07 19:42:15|157.23            |9          |1       |0        |
|154132544963934|United Kingdom|2021-07-07 19:42:21|104.13000000000001|4          |1       |0        |
|154132544963935|United Kingdom|2021-07-07 19:42:45|361.49            |11         |1       |0        |
|154132544963936|United Kingdom|2021-07-07 19:42:50|12.52             |2          |1       |0        |
|154132544963937|United Kingdom|2021-07-07 19:42:59|19.919999999999998|1          |1       |0        |
+---------------+--------------+-------------------+------------------+-----------+--------+---------+

-------------------------------------------
Batch: 9
-------------------------------------------
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost        |total_items|is_order|is_return|
+---------------+--------------+-------------------+------------------+-----------+--------+---------+
|154132544963938|United Kingdom|2021-07-07 19:43:11|207.25            |8          |1       |0        |
|154132544963939|United Kingdom|2021-07-07 19:43:16|42.629999999999995|5          |1       |0        |
|154132544963940|Unspecified   |2021-07-07 19:43:27|-16.5             |1          |0       |1        |
|154132544963941|United Kingdom|2021-07-07 19:43:42|5.95              |1          |1       |0        |
|154132544963942|United Kingdom|2021-07-07 19:43:43|-34.47            |2          |0       |1        |
|154132544963943|United Kingdom|2021-07-07 19:43:45|4.1               |2          |1       |0        |
|154132544963944|United Kingdom|2021-07-07 19:43:51|127.94            |9          |1       |0        |
|154132544963945|United Kingdom|2021-07-07 19:43:52|504.45000000000005|1          |1       |0        |
+---------------+--------------+-------------------+------------------+-----------+--------+---------+

Traceback (most recent call last):
  File "/root/Retail_Data_Project/Retail_Data_Project/spark-streaming.py", line 153, in <module>
    orderOutputStream.awaitTermination()
  File "/opt/cloudera/parcels/SPARK2-2.3.0.cloudera2-1.cdh5.13.3.p0.316101/lib/spark2/python/lib/pyspark.zip/pyspark/sql/streaming.py", line 106, in awaitTermination
  File "/opt/cloudera/parcels/SPARK2-2.3.0.cloudera2-1.cdh5.13.3.p0.316101/lib/spark2/python/lib/py4j-0.10.6-src.zip/py4j/java_gateway.py", line 1158, in __call__
  File "/opt/cloudera/parcels/SPARK2-2.3.0.cloudera2-1.cdh5.13.3.p0.316101/lib/spark2/python/lib/py4j-0.10.6-src.zip/py4j/java_gateway.py", line 908, in send_command
  File "/opt/cloudera/parcels/SPARK2-2.3.0.cloudera2-1.cdh5.13.3.p0.316101/lib/spark2/python/lib/py4j-0.10.6-src.zip/py4j/java_gateway.py", line 1055, in send_command
  File "/opt/cloudera/parcels/Anaconda-2019.10/lib/python2.7/socket.py", line 451, in readline
    data = self._sock.recv(self._rbufsize)
  File "/opt/cloudera/parcels/SPARK2-2.3.0.cloudera2-1.cdh5.13.3.p0.316101/lib/spark2/python/lib/pyspark.zip/pyspark/context.py", line 234, in signal_handler
KeyboardInterrupt
